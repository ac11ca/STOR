{% extends 'default/default_shell.html.twig' %}

{% block title %}{{Product.Name}} - Reviews{% endblock %}

{% block pageclass%}reviews-page{% endblock%}

{% block pageunloadcategory %}CRS_{{Product.ID}}_Time_End{% endblock %}

{% block primarybody %}

<div id="review_content" class="track-pageview" data-category="CRS_{{Product.ID}}_Time_Start" data-label="Visit: {{visit}}" >

    <div id="review_header">
        <h2 id="review_heading"> Individual Customer Reviews </h2>

        <div id="sort_container">
            <form method="post" id="sortform" name="sortform">
                <select name="sort" id="sort" onchange="sortform.submit();" data-event="change" data-category="CRS_{{Product.ID}}_Sort" data-label="Visit: {{visit}}">
                    <option value="e.created:DESC" {% if sort == 'e.created:DESC'%}selected{% endif %}>Sort by date (Descending)</option>
                    <option value="e.created:ASC" {% if sort == 'e.created:ASC'%}selected{% endif %}>Sort by date (Ascending)</option>
                    <option value="e.rating:ASC" {% if sort == 'e.rating:ASC'%}selected{% endif %}>Sort by rating (Ascending)</option>
                    <option value="e.rating:DESC" {% if sort == 'e.rating:DESC'%}selected{% endif %}>Sort by rating (Descending)</option>
                    <option value="e.help_score:ASC" {% if sort == 'e.help_score:ASC'%}selected{% endif %}>Sort by helpful (Ascending)</option>
                    <option value="e.help_score:DESC" {% if sort == 'e.help_score:DESC'%}selected{% endif %}>Sort by helpful (Descending)</option>
                    <option value="e.title:ASC" {% if sort == 'e.title:ASC'%}selected{% endif %}>Sort by title (Ascending)</option>
                    <option value="e.title:DESC" {% if sort == 'e.title:DESC'%}selected{% endif %}>Sort by title (Descending)</option>
                </select>
            </form>
        </div>
    </div>


    <div id="page_data">
        <p>Displaying {{(page-1) * (reviews_per_page) + 1}}-{{(reviews|length) + ((page-1)*(reviews_per_page))}} of {{review_count}} results.</p>
    </div>


    {% for Review in reviews %}
        <div id="review_{{loop.index0}}" class="review-listing">
            <div class="review-data">

                <div class="review-row">
                    <div class="review-data-rating">
                        <div class="star-ratings-sprite"><span style="width:{% if Review.rating is defined %}{{(Review.Rating/5)*100}}{% else %}0{% endif %}%" class="star-ratings-sprite-rating"></span></div>
                    </div>

                    <div class="review-data-title">
                        {{Review.title}}
                    </div>
                </div>

                <div class="review-row">
                    <div class="review-data-reviewer">
                       By {{Review.reviewer}}
                    </div>     
                
                    <div class="review-data-created">
                       on <span class="js-date" data-timestamp="{{Review.created}}" data-format="MMM DD, YYYY"></span>
                    </div> 
                </div>
            </div>

            <div class="review-comment">
                {{Review.comment|raw}}
            </div>

            <div class="review-helpscore">
                {{Review.helpScore}} <span>Number of people who found this review helpful.</span>
            </div>
        </div>
    {% endfor %}


    {% if page > 1 %}
        <div id="review_more_button">
            <a href="{{path('product_reviews', {product:Product.id, page:(page-1)})}}" class="btn btn-primary">Previous</a>
        </div>
    {% endif %}

    {% if (reviews_per_page * page) < review_count %}
        <div id="review_more_button">
            <a href="{{path('product_reviews', {product:Product.id, page:(page+1)})}}" class="btn btn-primary">See more</a>
        </div>
    {% endif %}

</div>

 {% embed 'default/components/navigation.html.twig' with  {'category':'CRS_' ~ Product.Id, purchase:true,abandon:true, visit: visit, back: true, term: term} %}{% endembed %}

{% endblock %}
